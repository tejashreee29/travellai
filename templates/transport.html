<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transport Guide - TravelPlan</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <header>
        <h1>‚úàÔ∏è TravelPlan</h1>
        <div>
            <span>Welcome, <strong>{{ user }}</strong></span>
            <a href="/dashboard">Dashboard</a> | 
            <a href="/logout">Sign Out</a>
        </div>
    </header>

    <div class="transport-container">
        <div class="card" style="margin-top: 2rem;">
            <h2 style="margin-bottom: 1.5rem;">üöå City Transport Guide</h2>
            <form method="POST" style="display: flex; gap: 1rem; align-items: end;">
                <div style="flex: 1;">
                    <input 
                        type="text" 
                        name="city" 
                        placeholder="Enter City Name" 
                        value="{{ city or '' }}"
                        required
                        style="width: 100%; padding: 0.75rem;"
                    >
                </div>
                <button type="submit" style="padding: 0.75rem 2rem;">Search</button>
            </form>
        </div>

        {% if city %}
        <div style="margin: 1.5rem 0; padding: 1rem; background: #e3f2fd; color: var(--primary-color); border-radius: 8px; text-align: center; border-left: 3px solid var(--primary-color);">
            <strong>Transport Information for {{ city }}</strong>
        </div>

        {% if recommendations %}
        <div class="card" style="margin: 2rem 0; background: linear-gradient(135deg, #2193b0 0%, #197896 100%); color: white;">
            <h2 style="color: white; margin-bottom: 1.5rem;">üöó Recommended Transport Modes</h2>
            
            {% if recommendations.primary %}
            <div style="margin-bottom: 2rem;">
                <h3 style="color: white; margin-bottom: 1rem;">‚≠ê Primary Recommendations</h3>
                {% for rec in recommendations.primary %}
                <div style="background: rgba(255,255,255,0.1); padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem; backdrop-filter: blur(10px);">
                    <h4 style="color: white; margin-bottom: 0.5rem;">{{ rec.mode }}</h4>
                    <p style="margin-bottom: 0.75rem; opacity: 0.9;">{{ rec.reason }}</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
                        <div>
                            <strong style="color: #6dd5ed;">‚úÖ Pros:</strong>
                            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                                {% for pro in rec.pros %}
                                <li>{{ pro }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% if rec.cons %}
                        <div>
                            <strong style="color: #ffb74d;">‚ö†Ô∏è Cons:</strong>
                            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                                {% for con in rec.cons %}
                                <li>{{ con }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            
            {% if recommendations.secondary %}
            <div style="margin-bottom: 2rem;">
                <h3 style="color: white; margin-bottom: 1rem;">üîπ Alternative Options</h3>
                {% for rec in recommendations.secondary %}
                <div style="background: rgba(255,255,255,0.1); padding: 1.5rem; border-radius: 8px; margin-bottom: 1rem; backdrop-filter: blur(10px);">
                    <h4 style="color: white; margin-bottom: 0.5rem;">{{ rec.mode }}</h4>
                    <p style="margin-bottom: 0.75rem; opacity: 0.9;">{{ rec.reason }}</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
                        <div>
                            <strong style="color: #6dd5ed;">‚úÖ Pros:</strong>
                            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                                {% for pro in rec.pros %}
                                <li>{{ pro }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% if rec.cons %}
                        <div>
                            <strong style="color: #ffb74d;">‚ö†Ô∏è Cons:</strong>
                            <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
                                {% for con in rec.cons %}
                                <li>{{ con }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            
            {% if recommendations.tips %}
            <div style="background: rgba(255,255,255,0.15); padding: 1.5rem; border-radius: 8px; margin-top: 1.5rem;">
                <h3 style="color: white; margin-bottom: 1rem;">üí° Travel Tips</h3>
                <ul style="margin: 0; padding-left: 1.5rem;">
                    {% for tip in recommendations.tips %}
                    <li style="margin-bottom: 0.5rem;">{{ tip }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
        </div>
        {% endif %}

        <div class="transport-section">
            <h4>üöå Bus Routes</h4>
            {% if bus_data and bus_data|length > 0 %}
            <ul>
                {% for row in bus_data %}
                <li>
                    {% if row is mapping %}
                        {% for key, value in row.items() %}
                            <strong>{{ key }}:</strong> {{ value }}<br>
                        {% endfor %}
                    {% else %}
                        {{ row }}
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p style="color: var(--text-light);">No bus data available.</p>
            {% endif %}
        </div>

        <div class="transport-section">
            <h4>üõ£ Road Network</h4>
            {% if road_data and road_data|length > 0 %}
            <ul>
                {% for row in road_data %}
                <li>
                    {% if row is mapping %}
                        {% for key, value in row.items() %}
                            <strong>{{ key }}:</strong> {{ value }}<br>
                        {% endfor %}
                    {% else %}
                        {{ row }}
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p style="color: var(--text-light);">No road data available.</p>
            {% endif %}
        </div>

        <div class="transport-section">
            <h4>üö¶ Traffic Conditions</h4>
            {% if traffic_data and traffic_data|length > 0 %}
            <ul>
                {% for row in traffic_data %}
                <li>
                    {% if row is mapping %}
                        {% for key, value in row.items() %}
                            <strong>{{ key }}:</strong> {{ value }}<br>
                        {% endfor %}
                    {% else %}
                        {{ row }}
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p style="color: var(--text-light);">No traffic data available.</p>
            {% endif %}
        </div>

        <div class="transport-section">
            <h4>üöÜ Public Transport Usage</h4>
            {% if commuter_data and commuter_data|length > 0 %}
            <ul>
                {% for row in commuter_data %}
                <li>
                    {% if row is mapping %}
                        {% for key, value in row.items() %}
                            <strong>{{ key }}:</strong> {{ value }}<br>
                        {% endfor %}
                    {% else %}
                        {{ row }}
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p style="color: var(--text-light);">No public transport data available.</p>
            {% endif %}
        </div>
        {% endif %}
    </div>

    <div id="chatbot"></div>

    <script src="/static/chatbot.js"></script>
</body>
</html>
